(function framework7ComponentLoader(e,t){void 0===t&&(t=!0);document,window;var s=e.$,o=(e.Template7,e.utils),a=(e.device,e.support),p=(e.Class,e.Modal),i=(e.ConstructorMethods,e.ModalMethods),n=function(e){function t(t,p){var i=o.extend({on:{}},t.params.sheet,p);e.call(this,t,i);var n,r,l,c=this;if(c.params=i,void 0===c.params.backdrop&&(c.params.backdrop="ios"!==t.theme),(n=c.params.el?s(c.params.el).eq(0):s(c.params.content).filter(function(e,t){return 1===t.nodeType}).eq(0))&&n.length>0&&n[0].f7Modal)return n[0].f7Modal;if(0===n.length)return c.destroy();function d(e){var o=e.target,a=s(o);!t.device.desktop&&t.device.cordova&&(window.Keyboard&&window.Keyboard.isVisible||window.cordova.plugins&&window.cordova.plugins.Keyboard&&window.cordova.plugins.Keyboard.isVisible)||0===a.closest(c.el).length&&(c.params.closeByBackdropClick&&c.params.backdrop&&c.backdropEl&&c.backdropEl===o?c.close():c.params.closeByOutsideClick&&c.close())}function m(e){27===e.keyCode&&c.params.closeOnEscape&&c.close()}c.params.backdrop&&c.params.backdropEl?r=s(c.params.backdropEl):c.params.backdrop&&0===(r=t.root.children(".sheet-backdrop")).length&&(r=s('<div class="sheet-backdrop"></div>'),t.root.append(r)),o.extend(c,{app:t,$el:n,el:n[0],$backdropEl:r,backdropEl:r&&r[0],type:"sheet"});var h,f,u,g,v,w,C,y,k,b,T,O,E=!1,M=!1;function S(e){E||!c.params.swipeToClose&&!c.params.swipeToStep||c.params.swipeHandler&&0===s(e.target).closest(c.params.swipeHandler).length||(E=!0,M=!1,h={x:"touchstart"===e.type?e.targetTouches[0].pageX:e.pageX,y:"touchstart"===e.type?e.targetTouches[0].pageY:e.pageY},g=o.now(),u=void 0,w=n.hasClass("sheet-modal-top"))}function B(e){if(E){if(f={x:"touchmove"===e.type?e.targetTouches[0].pageX:e.pageX,y:"touchmove"===e.type?e.targetTouches[0].pageY:e.pageY},void 0===u&&(u=!!(u||Math.abs(f.x-h.x)>Math.abs(f.y-h.y))),u)return E=!1,void(M=!1);v=h.y-f.y,M||(b=n[0].offsetHeight,y=o.getTranslate(n[0],"y"),w?(T=c.params.swipeToClose?-b:-C,O=0):(T=0,O=c.params.swipeToClose?b:C),M=!0),k=y-v,k=Math.min(Math.max(k,T),O),e.preventDefault(),n.transition(0).transform("translate3d(0,"+k+"px,0)")}}function x(){if(E=!1,M){M=!1,n.transform("").transition("");var e=v<0?"to-bottom":"to-top",t=Math.abs(v);if(0!==t&&k!==y){var s=(new Date).getTime()-g;if(c.params.swipeToStep){var o=w?"to-bottom":"to-top",a=w?"to-top":"to-bottom",p=Math.abs(k),i=Math.abs(C);if(s<300&&t>10)return e===o&&p<i&&(n.removeClass("modal-in-swipe-step"),n.trigger("sheet:stepopen"),c.emit("local::stepOpen sheetStepOpen",c)),e===a&&p>i&&(c.params.swipeToClose?c.close():(n.addClass("modal-in-swipe-step"),n.trigger("sheet:stepclose"),c.emit("local::stepClose sheetStepClose",c))),void(e===a&&p<=i&&(n.addClass("modal-in-swipe-step"),n.trigger("sheet:stepclose"),c.emit("local::stepClose sheetStepClose",c)));if(s>=300){var r=!n.hasClass("modal-in-swipe-step");r?r&&(p>i+(b-i)/2?c.params.swipeToClose&&c.close():p>i/2&&(n.addClass("modal-in-swipe-step"),n.trigger("sheet:stepclose"),c.emit("local::stepClose sheetStepClose",c))):p<i/2?(n.removeClass("modal-in-swipe-step"),n.trigger("sheet:stepopen"),c.emit("local::stepOpen sheetStepOpen",c)):p-i>(b-i)/2&&c.params.swipeToClose&&c.close()}}else{if(e!==(w?"to-top":"to-bottom"))return;(s<300&&t>20||s>=300&&t>b/2)&&c.close()}}}}function H(e){var t=n.find(".sheet-modal-swipe-step").eq(0);t.length&&(C=n.hasClass("sheet-modal-top")?-(t.offset().top-n.offset().top+t[0].offsetHeight):n[0].offsetHeight-(t.offset().top-n.offset().top+t[0].offsetHeight),n[0].style.setProperty("--f7-sheet-swipe-step",C+"px"),e||n.addClass("modal-in-swipe-step"))}function q(){H(!0)}var K=!!a.passiveListener&&{passive:!0};return(c.params.swipeToClose||c.params.swipeToStep)&&(n.on(t.touchEvents.start,S,K),t.on("touchmove",B),t.on("touchend:passive",x),c.once("sheetDestroy",function(){n.off(t.touchEvents.start,S,K),t.off("touchmove",B),t.off("touchend:passive",x)})),c.on("sheetOpen",function(){c.params.closeOnEscape&&s(document).on("keydown",m),c.params.swipeToStep&&(H(),t.on("resize",q)),c.params.scrollToEl&&function(){var e=s(c.params.scrollToEl).eq(0);if(0!==e.length&&0!==(l=e.parents(".page-content")).length){var t,o=parseInt(l.css("padding-top"),10),a=parseInt(l.css("padding-bottom"),10),p=l[0].offsetHeight-o-n.height(),i=l[0].scrollHeight-o-n.height(),r=l.scrollTop(),d=e.offset().top-o+e[0].offsetHeight;if(d>p){var m=r+d-p;m+p>i&&(t=m+p-i+a,p===i&&(t=n.height()),l.css({"padding-bottom":t+"px"})),l.scrollTop(m,300)}}}()}),c.on("sheetOpened",function(){(c.params.closeByOutsideClick||c.params.closeByBackdropClick)&&t.on("click",d)}),c.on("sheetClose",function(){c.params.swipeToStep&&(n.removeClass("modal-in-swipe-step"),t.off("resize",q)),c.params.closeOnEscape&&s(document).off("keydown",m),c.params.scrollToEl&&l&&l.length>0&&l.css({"padding-bottom":""}),(c.params.closeByOutsideClick||c.params.closeByBackdropClick)&&t.off("click",d)}),c.stepOpen=function(){n.removeClass("modal-in-swipe-step")},c.stepClose=function(){n.addClass("modal-in-swipe-step")},c.stepToggle=function(){n.toggleClass("modal-in-swipe-step")},n[0].f7Modal=c,c}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(p),r={name:"sheet",params:{sheet:{backdrop:void 0,backdropEl:void 0,closeByBackdropClick:!0,closeByOutsideClick:!1,closeOnEscape:!1,swipeToClose:!1,swipeToStep:!1,swipeHandler:null}},static:{Sheet:n},create:function(){var e=this;e.sheet=o.extend({},i({app:e,constructor:n,defaultSelector:".sheet-modal.modal-in"}),{stepOpen:function(t){var s=e.sheet.get(t);if(s&&s.stepOpen)return s.stepOpen()},stepClose:function(t){var s=e.sheet.get(t);if(s&&s.stepClose)return s.stepClose()},stepToggle:function(t){var s=e.sheet.get(t);if(s&&s.stepToggle)return s.stepToggle()}})},clicks:{".sheet-open":function(e,t){void 0===t&&(t={});s(".sheet-modal.modal-in").length>0&&t.sheet&&s(t.sheet)[0]!==s(".sheet-modal.modal-in")[0]&&this.sheet.close(".sheet-modal.modal-in"),this.sheet.open(t.sheet,t.animate)},".sheet-close":function(e,t){void 0===t&&(t={});this.sheet.close(t.sheet,t.animate)}}};if(t){if(e.prototype.modules&&e.prototype.modules[r.name])return;e.use(r),e.instance&&(e.instance.useModuleParams(r,e.instance.params),e.instance.useModule(r))}return r}(Framework7, typeof Framework7AutoInstallComponent === 'undefined' ? undefined : Framework7AutoInstallComponent))
